!function(){"use strict";class t extends HTMLElement{static get observedAttributes(){return["src","width","height"]}get player(){return this._player}get runConfig(){return this._runConfig}get src(){return this.getAttribute("src")}set src(t){this.setAttribute("src",t)}set width(t){this.setAttribute("width",t)}get width(){return this.getAttribute("width")}set height(t){this.setAttribute("height",t)}get height(){return this.getAttribute("height")}constructor(){super(),this._runConfig={},this.onError=this.onError.bind(this),this._root=this.attachShadow({mode:"closed"})}_getRuntimeUrl(){const t=this._runConfig.runtimebaseurl;return{loader:new URL(this._runConfig.loaderurl,t).href,runtime:new URL(this._runConfig.runtimeurl,t).href,baseUrl:t}}_dropPlayer(){this._gameFrame&&(this._gameFrame.remove(),this._player=null)}onError(t){const e=this._runConfig.onerror&&self[this._runConfig.onerror];"function"==typeof e&&e(t),this.dispatchEvent(new ErrorEvent("error",{error:new Error("Awayfl runtime error"),message:(null==t?void 0:t.message)||t}))}_attachRuntimeEvents(){const t=this._gameFrame.contentWindow;t.addEventListener("awayfl-player-init",(({detail:t})=>{this._player=t}),{once:!0}),t.addEventListener("awayfl-player-load",(()=>{const t=this._runConfig.onload&&self[this._runConfig.onload];"function"==typeof t&&t(),this.dispatchEvent(new CustomEvent("load")),this._gameFrame.style.display=""}),{once:!0}),t.addEventListener("awayfl-player-progress",(({detail:t})=>{const e=this._runConfig.onprogress&&self[this._runConfig.onprogress];"function"==typeof e&&e(t),this.dispatchEvent(new CustomEvent("progress",{detail:t}))}))}_buildTemplate(t){const e='<!DOCTYPE html>\n<head>\n\t<meta name="viewport"\n\t\tcontent="height=device-height, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />\n\t<title>AwayFL Embedded Player 0.0.33</title>\n\t<style>\n\t\t* {\n\t\t\tmargin: 0;\n\t\t\tpadding: 0;\n\t\t}\n\n\t\tcanvas {\n\t\t\toutline: none\n\t\t}\n\n\t\thtml, body, #container {\n\t\t\tmargin: 0;\n\t\t\toverflow: hidden;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tbackground-color: black;\n\t\t}\n\n\t\t#splash__image {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tposition: absolute;\n\t\t\tbackground-size: contain;\n\t\t\tbackground-position: center;\n\t\t\tbackground-repeat: no-repeat;\n\t\t\tvisibility: visible;\n\t\t\ttransition: all 0.5s;\n\t\t\tz-index: 10;\n\t\t}\n\n\t\t#progress__root {\n\t\t\tposition: absolute;\n\t\t}\n\n\t\t#progress__line {\n\t\t\twidth: 0;\n\t\t\theight: 100%;\n\t\t\ttransition: all 0.5s;\n\t\t}\n\t</style>\n\t<script src="__LOADER_URL__"><\/script>\n</head>\n\n<body>\n\t<div id="splash__image">\n\t\t<div id="progress__root">\n\t\t\t<div id="progress__line"></div>\n\t\t</div>\n\t</div>\n\t<script>\n\t\twindow.addEventListener("load", () => {\n\n\t\t\tconst config = JSON.parse(__GAME_CONFIG__);\n\n\t\t\tAWAYFL.LegacyLoader.init(config);\n\t\t\tAWAYFL.LegacyLoader.runGame((fill) => {\n\t\t\t\twindow.dispatchEvent(new CustomEvent(\'awayfl-player-progress\', {detail: fill}));\n\t\t\t}, (config, hideLoader) => {\n\t\t\t\tconst player = new AWAYFL.Player(document, config);\n\t\t\t\twindow.dispatchEvent(new CustomEvent(\'awayfl-player-init\', {detail: player}));\n\t\t\t\tplayer\n\t\t\t\t\t.loadAndPlay()\n\t\t\t\t\t.then((_, hide) => {\n\t\t\t\t\t\twindow.dispatchEvent(new CustomEvent(\'awayfl-player-load\'));\n\t\t\t\t\t\thide && hide() || window.swfParseComplete && window.swfParseComplete();;\n\t\t\t\t\t});\t\t\t\t\n\t\t\t})\n\t\t});\n\t<\/script>\n</body>',n=this._getRuntimeUrl(),r=window.AWAY_EMBED_CFG,i={width:t.clientWidth,height:t.clientHeight,splash:"string"==typeof r.splash&&r.splash||"splash.jpg",progress:r.progress||{direction:"lr",back:"#130d02",line:"#f29f01",rect:[.25,.77,.5,.01]},runtime:[n.runtime],binary:[{path:this._runConfig.src,resourceType:"GAME",name:"Game",meta:{}}],baseUrl:n.baseUrl,maxStageScale:+this._runConfig.maxstagescale,runtimeFlags:{defaultSmoothBitmap:!!this._runConfig.smoothbitmapdefault}};return e.replace(/__LOADER_URL__/,n.loader).replace(/__GAME_CONFIG__/,JSON.stringify(JSON.stringify(i)))}_constructPlayer(){const t=this._root,e=document.createElement("iframe");e.style.border="none",e.style.display=this._runConfig.hidebeforeload?"none":"",e.width=""+this._runConfig.width,e.height=""+this._runConfig.height,this._gameFrame=e,t.appendChild(e),e.addEventListener("load",this._attachRuntimeEvents.bind(this),{once:!0}),e.addEventListener("error",this.onError),e.srcdoc=this._buildTemplate(e)}_mapAttrs(){const e=this.querySelectorAll("param"),n=this.getAttributeNames(),r=t.BINDING_CONFIG;e.forEach((t=>{t.name in r&&(this._runConfig[t.name]=t.value)})),n.forEach((t=>{t in r&&(this._runConfig[t]=this.getAttribute(t))}));for(const t in r){if(r[t].required&&void 0===this._runConfig[t])throw`Parameter ${t} is required!`;void 0===this._runConfig[t]&&(this._runConfig[t]=r[t].default)}}_loadGlobalConfig(){const e=window.AWAY_EMBED_CFG,n=t.BINDING_CONFIG;for(const[t,r]of Object.entries(e))t in n&&(this._runConfig[t]=r)}connectedCallback(){setTimeout((()=>{this._loaderHolder=this.querySelector("div.awayfl__loader"),this._loadGlobalConfig(),this._mapAttrs(),this._constructPlayer();const t=document.createElement("style");t.textContent=`\n            :host {\n                display: block;\n                contain: content;\n                width: ${this._runConfig.width};\n                height: ${this._runConfig.height};\n            }\n            `,this._root.appendChild(t)}))}disconnectedCallback(){this._dropPlayer()}attributeChangedCallback(t,e,n){if(this.isConnected)return"src"===t&&this._player?(this._dropPlayer(),this._runConfig.src=n,void this._constructPlayer()):void("width"!==t&&"height"!==t||this._root.styleSheets[0].insertRule(`:host { ${t}: ${n};}`))}}t.BINDING_CONFIG={version:{required:!1,default:"latest"},runtimebaseurl:{required:!0},loaderurl:{required:!1,default:"loader.js"},runtimeurl:{required:!1,default:"runtime.js"},src:{required:!0},avm1:{required:!1,default:!1},width:{required:!1,default:550},height:{required:!1,default:400},onload:{required:!1},onprogress:{required:!1},onerror:{required:!1},scaleMode:{required:!1,default:"all"},autoplay:{required:!1,default:!0},hidebeforeload:{required:!1,default:!1},maxstagescale:{required:!1,default:void 0},smoothbitmapdefault:{required:!1,default:!1}},customElements.define("awayfl-player",t);const e=t=>console.warn("AwayFL loader does not support "+t),n=document.currentScript.src,r=window;let i;r.swfObject&&console.warn("Replace `swfObject` with AwayFl loader!"),document.addEventListener("load",(()=>{}));const s={registerObject:()=>e("registerObject"),getObjectById:()=>e("getObjectById"),switchOffAutoHideShow:()=>e("switchOffAutoHideShow"),enableUriEncoding:()=>e("enableUriEncoding"),getFlashPlayerVersion:()=>e("getFlashPlayerVersion"),createSWF:()=>e("createSWF"),showExpressInstall:()=>e("showExpressInstall"),createCSS:()=>e("createCSS"),getQueryParamValue:()=>e("getQueryParamValue"),get ua(){return e("ua")},embedSWF:function(e,s,o,a,l,d,h,u,c,g){const f="string"==typeof s?document.getElementById(s):s,_=function(e,s,o,a){r.AWAY_EMBED_CFG||(console.info("AwayFL configuration not found. To set custom options, define a `AWAY_EMBED_CFG` object as explained in the Readme"),r.AWAY_EMBED_CFG={}),i=r.AWAY_EMBED_CFG;let l=i.baseUrl,d=i.loaderUrl,h=i.runtimeUrl;const u=i.splash;i.progress,l||(l=new URL(".",n).href);const c=new t;c.setAttribute("src",e),c.setAttribute("width",o),c.setAttribute("height",a),c.setAttribute("runtimebaseurl",l),d&&c.setAttribute("loaderurl",d),h&&c.setAttribute("runtimeurl",h),!1===u&&c.setAttribute("hidebeforeload","true");const g=s.id,f=s.className,_=s.parentElement;return s.id=null,s.className="",c.id=g,c.className=f,_.replaceChild(c,s),c}(e,f,o,a);_.onload=()=>{g&&g({success:!0,ref:_,id:f.id})}}};r.swfObject=s}();
//# sourceMappingURL=embed.js.map
